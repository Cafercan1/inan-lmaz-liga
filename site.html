<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<title>Elite Spectrum League</title>
<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-app.js";
import { getFirestore, doc, getDoc } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore.js";

// ðŸ”¹ FIREBASE CONFIG
const firebaseConfig = {
  apiKey: "AIzaSyCsgGry8f3TkjZF8ejJjawb8vO1yhpQH8s",
  authDomain: "lig-a-794ad.firebaseapp.com",
  projectId: "lig-a-794ad",
  storageBucket: "lig-a-794ad.appspot.com",
  messagingSenderId: "868678155723",
  appId: "1:868678155723:web:cba4e929899704523aca4e",
  measurementId: "G-HQW4EHNHBE"
};
const app = initializeApp(firebaseConfig);
const db = getFirestore(app);

// ðŸ”¹ KullanÄ±cÄ±yÄ± al
const currentUser = localStorage.getItem("currentUser");
if(!currentUser) window.location = "index.html"; // giriÅŸ yapÄ±lmamÄ±ÅŸsa

let userTeams = [];

async function getUserTeams() {
  const docRef = doc(db, "users", currentUser);
  const docSnap = await getDoc(docRef);
  if(docSnap.exists()){
    userTeams.push(docSnap.data().team1);
    if(docSnap.data().team2) userTeams.push(docSnap.data().team2);
  }
}

// ðŸ”¹ Tablonun verilerini ve sÄ±ralamasÄ±nÄ± gÃ¼ncelle
function tabloyuGuncelleVeSirala() {
  const tablo = document.querySelector("#puanTablosu tbody");
  const satirlar = Array.from(tablo.rows);

  satirlar.forEach(satir => {
    const ag = parseInt(satir.cells[6].innerText); 
    const yg = parseInt(satir.cells[7].innerText); 
    satir.cells[8].innerText = ag - yg;

    // ðŸ”¹ KullanÄ±cÄ± takÄ±mlarÄ±nÄ± Ã¶ne Ã§Ä±kar
    if(userTeams.includes(satir.cells[1].innerText)){
      satir.style.backgroundColor = "#fffa91"; // sarÄ± vurgulu
      satir.style.fontWeight = "bold";
    }
  });

  satirlar.sort((a,b)=>{
    const puanB = parseInt(b.cells[9].innerText);
    const puanA = parseInt(a.cells[9].innerText);
    const avB = parseInt(b.cells[8].innerText);
    const avA = parseInt(a.cells[8].innerText);
    const agB = parseInt(b.cells[6].innerText);
    const agA = parseInt(a.cells[6].innerText);

    if(puanB!==puanA) return puanB-puanA;
    if(avB!==avA) return avB-avA;
    return agB-agA;
  });

  satirlar.forEach((satir,index)=>{
    satir.cells[0].innerText = index+1;
    tablo.appendChild(satir);
  });
}

// ðŸ”¹ Sayfa yÃ¼klendiÄŸinde
window.onload = async ()=>{
  await getUserTeams();
  tabloyuGuncelleVeSirala();

  // ðŸ”¹ ÅžarkÄ±yÄ± baÅŸlat
  const audio = document.createElement("iframe");
  audio.width = "0";
  audio.height = "0";
  audio.src = "https://www.youtube.com/embed/u9oSVuf-0rc?autoplay=1&loop=1&playlist=u9oSVuf-0rc";
  audio.allow = "autoplay";
  document.body.appendChild(audio);
};
</script>


<style>
body {
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    margin: 20px;
    background: #0b1e3a; /* koyu lacivert */
    color: #fff;
}

h2 {
    margin-bottom: 15px;
    text-align: center;
    color: #f5c518; /* altÄ±n sarÄ±sÄ± */
    text-shadow: 2px 2px #000;
}

.table-container {
    overflow-x: auto;
    margin-top: 20px;
    border-radius: 12px;
    box-shadow: 0 6px 20px rgba(0,0,0,0.6);
}

table {
    border-collapse: collapse;
    width: 100%;
    background: #1c2b4a; /* koyu gri-mavi */
    border-radius: 10px;
    overflow: hidden;
}

th, td {
    padding: 12px;
    text-align: center;
    border-bottom: 1px solid #2a3a5a;
    color: #fff; /* yazÄ±lar beyaz */
}

th {
    background: linear-gradient(90deg, #3b5998, #4c70ba); /* mavi tonlarÄ± */
    font-size: 16px;
}

tr:hover:not(.user-team) {
    background: rgba(255,255,255,0.08);
}

.team {
    text-align: left;
    padding-left: 15px;
}

.points {
    font-weight: bold;
    color: #f5c518;
}

.form span {
    display: inline-block;
    width: 12px;
    height: 12px;
    margin: 2px;
    border-radius: 50%;
}

.form .w { background: #28a745; } /* kazandÄ± */
.form .d { background: #6c757d; } /* beraber */
.form .l { background: #dc3545; } /* kaybetti */

/* KullanÄ±cÄ± takÄ±mlarÄ±nÄ± vurgulama */
tr.user-team {
    background: #f5c518; /* parlak sarÄ± */
    color: #1b1b1b; /* koyu yazÄ± okunabilir */
    font-weight: bold;
}

/* Responsive */
@media (max-width: 768px) {
    th, td {
        padding: 8px;
        font-size: 14px;
    }
}
</style>


<h2>Elite Spectrum League - Lig Puan Durumu</h2>
<div class="table-container">
<table id="puanTablosu">
<thead>
<tr>
<th>#</th><th>TakÄ±m</th><th>OM</th><th>G</th><th>B</th><th>M</th><th>AG</th><th>YG</th><th>AV</th><th>P</th><th>Son 5</th>
</tr>
</thead>
<tbody>
<tr><td>1</td><td>Marsilya</td><td>1</td><td>1</td><td>0</td><td>0</td><td>4</td><td>0</td><td>4</td><td>3</td><td class="form"><span class="w"></span><span class="d"></span><span class="d"></span><span class="d"></span><span class="d"></span></td></tr>
<tr><td>2</td><td>Juventus</td><td>1</td><td>1</td><td>0</td><td>0</td><td>5</td><td>2</td><td>3</td><td>3</td><td class="form"><span class="w"></span><span class="d"></span><span class="d"></span><span class="d"></span><span class="d"></span></td></tr>
<tr><td>3</td><td>Borussia Dortmund</td><td>1</td><td>1</td><td>0</td><td>0</td><td>5</td><td>3</td><td>2</td><td>3</td><td class="form"><span class="w"></span><span class="d"></span><span class="d"></span><span class="d"></span><span class="d"></span></td></tr>
<tr><td>4</td><td>Ä°nter</td><td>1</td><td>0</td><td>1</td><td>0</td><td>4</td><td>4</td><td>0</td><td>1</td><td class="form"><span class="d"></span><span class="d"></span><span class="d"></span><span class="d"></span><span class="d"></span></td></tr>
<tr><td>5</td><td>Lyon</td><td>1</td><td>0</td><td>1</td><td>0</td><td>4</td><td>4</td><td>0</td><td>1</td><td class="form"><span class="d"></span><span class="d"></span><span class="d"></span><span class="d"></span><span class="d"></span></td></tr>
<tr><td>6</td><td>Liverpool</td><td>1</td><td>0</td><td>1</td><td>0</td><td>3</td><td>3</td><td>0</td><td>1</td><td class="form"><span class="d"></span><span class="d"></span><span class="d"></span><span class="d"></span><span class="d"></span></td></tr>
<tr><td>7</td><td>Atletico Madrid</td><td>1</td><td>0</td><td>1</td><td>0</td><td>3</td><td>3</td><td>0</td><td>1</td><td class="form"><span class="d"></span><span class="d"></span><span class="d"></span><span class="d"></span><span class="d"></span></td></tr>
<tr><td>8</td><td>Bayer Leverkusen</td><td>1</td><td>0</td><td>0</td><td>1</td><td>3</td><td>5</td><td>-2</td><td>0</td><td class="form"><span class="l"></span><span class="d"></span><span class="d"></span><span class="d"></span><span class="d"></span></td></tr>
<tr><td>9</td><td>Sevilla</td><td>1</td><td>0</td><td>0</td><td>1</td><td>2</td><td>5</td><td>-3</td><td>0</td><td class="form"><span class="l"></span><span class="d"></span><span class="d"></span><span class="d"></span><span class="d"></span></td></tr>
<tr><td>10</td><td>Arsenal</td><td>1</td><td>0</td><td>0</td><td>1</td><td>0</td><td>4</td><td>-4</td><td>0</td><td class="form"><span class="l"></span><span class="d"></span><span class="d"></span><span class="d"></span><span class="d"></span></td></tr>
</tbody>
</table>
</div>
</body>
</html>
