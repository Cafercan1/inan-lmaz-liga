<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<title>Mini Online Futbol</title>

<style>
body {
  margin: 0;
  background: #0b6623;
  display: flex;
  flex-direction: column;
  align-items: center;
  color: white;
  font-family: Arial, sans-serif;
}

canvas {
  background: #1ea93c;
  border: 4px solid white;
  margin-top: 10px;
}

.controls {
  margin: 10px;
}

.controls button {
  font-size: 28px;
  padding: 10px 20px;
  margin: 5px;
}
</style>
</head>

<body>

<h2>⚽ Mini Online Futbol</h2>

<canvas id="game" width="800" height="400"></canvas>

<div class="controls">
  <button onclick="move('up')">⬆️</button>
  <button onclick="move('down')">⬇️</button>
</div>

<!-- Firebase -->
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>

<script>
// Firebase Config kısmı
const firebaseConfig = {
  apiKey: "AIzaSyCsGuucpO-YYcuzxeG7fDV7JtgydpJtgoc",
  authDomain: "minigame-35891.firebaseapp.com",
  databaseURL: "https://minigame-35891-default-rtdb.firebaseio.com",
  projectId: "minigame-35891",
  storageBucket: "minigame-35891.firebasestorage.app",
  messagingSenderId: "256476370761",
  appId: "1:256476370761:web:c81c3c881f5e63a940ac98",
  measurementId: "G-MJ9EKF829W"
};

// Firebase'i başlat
firebase.initializeApp(firebaseConfig);
const db = firebase.database();
const gameRef = db.ref("game");

// Canvas
const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");

// Oyuncu ataması
let playerId = Math.random() > 0.5 ? "p1" : "p2";

// Oyun durumu
let game = {
  p1: { x: 50, y: 180 },
  p2: { x: 730, y: 180 },
  ball: { x: 400, y: 200, vx: 3, vy: 2 },
  score1: 0,
  score2: 0
};

// Firebase dinleme
gameRef.on("value", snap => {
  if (snap.exists()) game = snap.val();
  draw();
});

// Hareket fonksiyonu
function move(dir) {
  let p = game[playerId];
  if (!p) return;

  if (dir === "up") p.y -= 15;
  if (dir === "down") p.y += 15;

  p.y = Math.max(0, Math.min(360, p.y));
  gameRef.set(game);
}

// Klavye ile hareket
document.addEventListener("keydown", e => {
  if (e.key === "ArrowUp") move("up");
  if (e.key === "ArrowDown") move("down");
});

// Oyun döngüsü
setInterval(() => {
  game.ball.x += game.ball.vx;
  game.ball.y += game.ball.vy;

  if (game.ball.y < 0 || game.ball.y > 400) game.ball.vy *= -1;

  checkCollision(game.p1);
  checkCollision(game.p2);

  if (game.ball.x < 0) goal("p2");
  if (game.ball.x > 800) goal("p1");

  gameRef.set(game);
}, 30);

// Çarpışma kontrolü
function checkCollision(p) {
  if (
    game.ball.x > p.x &&
    game.ball.x < p.x + 20 &&
    game.ball.y > p.y &&
    game.ball.y < p.y + 40
  ) {
    game.ball.vx *= -1;
  }
}

// Gol işlemi
function goal(winner) {
  game.ball.x = 400;
  game.ball.y = 200;
  game.ball.vx *= -1;

  if (winner === "p1") game.score1++;
  if (winner === "p2") game.score2++;
}

// Çizim fonksiyonu
function draw() {
  ctx.clearRect(0, 0, 800, 400);

  // Orta çizgi
  ctx.setLineDash([10, 10]);
  ctx.strokeStyle = "white";
  ctx.beginPath();
  ctx.moveTo(400, 0);
  ctx.lineTo(400, 400);
  ctx.stroke();
  ctx.setLineDash([]);

  // Oyuncular
  ctx.fillStyle = "blue";
  ctx.fillRect(game.p1.x, game.p1.y, 20, 40);

  ctx.fillStyle = "red";
  ctx.fillRect(game.p2.x, game.p2.y, 20, 40);

  // Top
  ctx.fillStyle = "white";
  ctx.beginPath();
  ctx.arc(game.ball.x, game.ball.y, 8, 0, Math.PI * 2);
  ctx.fill();

  // Skor
  ctx.font = "20px Arial";
  ctx.fillText(game.score1, 360, 30);
  ctx.fillText(game.score2, 430, 30);
}
</script>

</body>
</html>
